# –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á OJS-–ø–∞—Ä–∏—Ç–µ—Ç–∞

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-11-06  
**–í–µ—Ç–∫–∞:** `feature/etl-and-urls`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã

## ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (100%)

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `base.py`, `dev.py`, `prod.py`
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω `django-environ`
- ‚úÖ –°–æ–∑–¥–∞–Ω `.env.example`
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (HSTS, CSP)

### 2. –ú–æ–¥–µ–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ ‚úÖ
- ‚úÖ –î–æ–ø–æ–ª–Ω–µ–Ω—ã `Issue` –∏ `Article` (slug, –∏–Ω–¥–µ–∫—Å—ã, get_absolute_url)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –º–æ–¥–µ–ª–∏: `ArticleLocale`, `Keyword`, `ArticleFile`
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –º–æ–¥–µ–ª–∏: `NewsLocale`, `PageLocale`, `Event`, `RawDocument`, `Affiliation`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `Redirect` (http_status, –∏–Ω–¥–µ–∫—Å—ã)
- ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã**

### 3. –ü–æ–∏—Å–∫ ‚úÖ
- ‚úÖ GIN –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è Postgres
- ‚úÖ API `/api/search` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Postgres –∏ SQLite
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–ø—É—Å–∫–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ slug –≤ URL —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 4. ETL –ø–∞–∫–µ—Ç ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω –ø–∞–∫–µ—Ç `etl/` —Å –º–æ–¥—É–ª—è–º–∏:
  - `util.py` - —É—Ç–∏–ª–∏—Ç—ã
  - `normalize.py` - –æ—á–∏—Å—Ç–∫–∞ HTML
  - `crawler.py` - –∫—Ä–∞—É–ª–µ—Ä OJS
  - `cli.py` - CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
  - `__main__.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

### 5. Management –∫–æ–º–∞–Ω–¥–∞ ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `import_jhd.py`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `--dry-run`
- ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ `RawDocument`

### 6. URL, –≤—å—é—Ö–∏ ‚úÖ
- ‚úÖ URLs –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ slug
- ‚úÖ `ArticleDetailView` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ slug –∏ pk
- ‚úÖ `file_download` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ Fallback –Ω–∞ pk –µ—Å–ª–∏ slug –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### 7. –†–µ–¥–∏—Ä–µ–∫—Ç—ã ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω `RedirectMiddleware`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å `Redirect`
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤

### 8. SEO ‚úÖ
- ‚úÖ `sitemap.xml` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π slug
- ‚úÖ `robots.txt` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ `ArticleSitemap` –æ–±–Ω–æ–≤–ª–µ–Ω

### 9. –ê–¥–º–∏–Ω–∫–∞ ‚úÖ
- ‚úÖ –í—Å–µ –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫

### 10. Makefile ‚úÖ
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üìã –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏

1. **issues.0002** - –î–æ–±–∞–≤–ª–µ–Ω slug –∫ Issue
2. **issues.0003** - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ slug –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤—ã–ø—É—Å–∫–æ–≤
3. **articles.0003** - –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (ArticleFile, ArticleLocale, Keyword) + slug
4. **articles.0004** - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ slug –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∞—Ç–µ–π
5. **core.0003** - –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (Affiliation, Event, NewsLocale, PageLocale, RawDocument) + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Redirect

## üîÑ –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### ETL –ø–∞—Ä—Å–µ—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å `_extract_article()` –∏ `_extract_issue()` –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É OJS
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ OJS XML —Ñ–æ—Ä–º–∞—Ç–∞
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å `files.py`
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å `mapping.py`

### –ö–æ–º–∞–Ω–¥–∞ –∏–º–ø–æ—Ä—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Å—Ç–∞—Ç–µ–π —Å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è–º–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç –≤—ã–ø—É—Å–∫–æ–≤
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç –∞–≤—Ç–æ—Ä–æ–≤ –∏ –∞—Ñ—Ñ–∏–ª–∏–∞—Ü–∏–π
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSV –æ—Ç—á–µ—Ç–∞

### –®–∞–±–ª–æ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞
- –î–æ–±–∞–≤–∏—Ç—å OpenGraph/Twitter meta —Ç–µ–≥–∏
- –î–æ–±–∞–≤–∏—Ç—å —Ö–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏

### –¢–µ—Å—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Smoke-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- INSTALL.md, DEPLOY.md, ETL.md, REDIRECTS.md

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 19
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 11
- **–°–æ–∑–¥–∞–Ω–æ –º–æ–¥–µ–ª–µ–π:** 8
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ –º–æ–¥–µ–ª–µ–π:** 3
- **–°–æ–∑–¥–∞–Ω–æ –º–∏–≥—Ä–∞—Ü–∏–π:** 5
- **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ –∞–¥–º–∏–Ω–∫–µ:** 8 –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫:
- ‚úÖ –†–∞–±–æ—Ç–µ —Å –Ω–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é slug –≤ URL
- ‚úÖ –ò–º–ø–æ—Ä—Ç—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ ETL
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç–∞–º —Å—Ç–∞—Ä—ã—Ö URL
- ‚úÖ –ü–æ–∏—Å–∫—É –ø–æ —Å—Ç–∞—Ç—å—è–º
- ‚úÖ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
make dev
# –∏–ª–∏
python manage.py runserver

# ETL –∫—Ä–∞—É–ª–∏–Ω–≥
make etl
# –∏–ª–∏
python -m etl crawl --start https://jhdkz.org/ --out data/raw.jsonl --langs ru,kk,en

# –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
make import
# –∏–ª–∏
python manage.py import_jhd --source data/raw.jsonl --lang ru,kk,en --since 2010 --dry-run

# –ü—Ä–æ–≤–µ—Ä–∫–∞
python manage.py check
python manage.py migrate
```

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Slug –¥–ª—è —Å—Ç–∞—Ç–µ–π:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞—Ç—å–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ slug (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Å—Ç—ã–µ). –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—å–∏ slug –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `save()`.

2. **Postgres:** –î–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –≤ Postgres —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ:
   ```sql
   CREATE EXTENSION IF NOT EXISTS pg_trgm;
   ```

3. **–ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã:** –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `media/jhdkz/<type>/<year>/<id-or-slug>/<filename>` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ.

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –æ—Å–æ–±–µ–Ω–Ω–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –∏ –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö.

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ –∏–º–ø–æ—Ä—Ç—É –¥–∞–Ω–Ω—ã—Ö.

